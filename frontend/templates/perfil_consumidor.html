{% extends "base.html" %}

{% block styles %}
    <link rel="stylesheet" href="{{ url_for('static', filename='css/perfil.css') }}">
{% endblock %}

{% block content %}
<div class="container">
    <div class="popular-section">

        <h1 class="section-title">🙋 Mi Perfil</h1>
        <div class="restaurant-card">
            <p><strong>Usuario:</strong> {{ usuario["nombre_usuario"] }}</p>
            <p><strong>Email:</strong> {{ usuario["email_usuario"] }}</p>
            <p><strong>Miembro desde:</strong> {{ usuario["fecha_creacion"] }}</p>
        </div>

        <h2 class="section-title clickable collapsed" onclick="toggleSection('reservas')">📅 Mis Reservas</h2>
        <div id="reservas" class="collapsible-content">
            {% if reservas %}
                <div class="list-reservas">
                    {% for reserva in reservas %}
                        <div class="info-reserva">
                            <p>{{ reserva["nombre_restaurante"] }} - {{ reserva["fecha"] }}
                                {% if reserva["estado"] %}
                                    <span class="estado-activa">Activa</span>
                                {% else %}
                                    <span class="estado-cancelada">Cancelada</span>
                                {% endif %}
                            </p>
                        </div>
                    {% endfor %}
                </div>
            {% else %}
                <div class="info-reserva">
                    <p>No tenés reservas activas.</p>
                </div>
            {% endif %}
        </div>

        <h2 class="section-title clickable collapsed" onclick="toggleSection('resenias')">📝 Mis Reseñas</h2>
        <div id="resenias" class="collapsible-content">
            <div class="list-resenias">
                {% if resenias %}
                    {% for resenia in resenias %}
                        <div class="info-resenia">
                            <p><strong>{{ resenia["nombre_restaurante"] }}</strong></p>
                            <p>{{ resenia["comentario"] }}</p>
                            <p>Puntaje:
                                {% for i in range(resenia["puntaje"]) %}
                                    ★
                                {% endfor %}
                            </p>
                        </div>
                    {% endfor %}
                {% else %}
                    <div class="info-resenia">
                        <p>No dejaste reseñas aún.</p>
                    </div>
                {% endif %}
            </div>
        </div>

        <h2 class="section-title clickable collapsed" onclick="toggleSection('favs')">♥ Mis favoritos</h2>
        <div id="favs" class="collapsible-content">
            <div class="list-favs">
                {% if favoritos %}
                    {% for fav in favoritos %}
                        <div class="info-fav"></div>
                    {% endfor %}
                {% else %}
                    <div class="info-fav">
                        <p>No seleccionaste nigun comercio favorito</p>
                    </div>
                {% endif %}
            </div>
        </div>
        <div class="back-section" style="text-align: center; margin-top: 30px;">
            <a href="/home"></a>
                <button class="back-btn">← Volver al inicio</button>
            </a>
        </div>

    </div>
</div>
{% endblock %}
{% block scripts %}
    <script src="{{ url_for('static', filename='js/perfil.js') }}"></script>
{% endblock %}
